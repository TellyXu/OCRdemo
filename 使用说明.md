# OCR 文档识别系统使用说明

## 项目文件

1. **ocr-frontend.html** - OCR 前端应用（网页界面）
2. **test_ocr_api.py** - Python 测试脚本（命令行工具）

## 使用方法

### 方法一：使用网页界面

1. 在浏览器中打开 `ocr-frontend.html` 文件
   > **注意**：直接在本地打开HTML文件可能会遇到跨域问题。请查看[跨域问题解决方案](#跨域问题解决方案)。
2. 支持两种上传方式：
   - 点击"选择文件"按钮选择文件
   - 直接拖拽文件到上传区域
3. 选择文件后，点击"开始识别"按钮
4. 等待处理完成，结果会自动显示在右侧
5. 可以在两种视图之间切换：
   - **渲染视图** - 格式化后的Markdown效果
   - **源代码** - 原始Markdown文本
6. 可以下载 Markdown 或 JSON 格式的结果

### 方法二：使用 Python 脚本（推荐）

1. 安装依赖：
   ```bash
   pip install requests
   ```

2. 运行脚本：
   ```bash
   python test_ocr_api.py <文件路径>
   ```

   示例：
   ```bash
   python test_ocr_api.py test.png
   python test_ocr_api.py document.pdf
   ```

3. 脚本会自动：
   - 上传文件到服务器
   - 轮询查询处理状态
   - 显示识别结果
   - 保存结果到本地（文件名_result.md）

## 跨域问题解决方案

由于浏览器的同源策略安全限制，直接在本地打开HTML文件访问远程API会遇到跨域资源共享(CORS)错误。以下是几种解决方案：

### 方案1：使用本地Web服务器（推荐）

使用简单的HTTP服务器来提供HTML文件：

**Python 方式**:
```bash
# 在项目目录下运行
python -m http.server 8080
```
然后在浏览器中访问：`http://localhost:8080/ocr-frontend.html`

**Node.js 方式**:
```bash
# 安装serve
npm install -g serve
# 在项目目录下运行
serve .
```

### 方案2：使用Python测试脚本

避开前端跨域问题，直接使用提供的Python脚本进行测试：
```bash
python test_ocr_api.py <文件路径>
```

### 方案3：使用浏览器扩展

某些浏览器扩展可以禁用跨域限制，方便开发测试：
- Chrome: "CORS Unblock" 或 "Allow CORS"
- Firefox: "CORS Everywhere"

**注意**：使用这些扩展会降低浏览器安全性，仅建议在测试环境中使用。

### 方案4：本地演示模式

前端应用内置了本地演示模式，当检测到跨域问题时会自动切换至此模式：
- 可以上传文件并查看模拟的OCR结果
- 界面显示会有"本地演示模式"的提示
- 所有功能和UI都可正常体验，但使用的是模拟数据

## 支持的文件格式

- PDF 文档
- PNG 图片
- JPEG/JPG 图片

## API 服务器信息

- 服务器地址：http://209.20.156.150:8000
- 主要端点：
  - POST /convert - 上传文件
  - GET /task/{task_id} - 查询状态
  - GET /result/{task_id} - 获取 Markdown 结果
  - GET /json/{task_id} - 获取 JSON 结果

## 功能特点

### 网页界面
- 🎨 现代化的界面设计
- 📤 支持拖拽上传
- ⏳ 实时处理进度条
- 📊 直观的百分比和状态显示
- 📝 专业的 Markdown 渲染 (使用 markdown-it)
- 🎨 代码语法高亮 (使用 highlight.js)
- 🔄 双视图切换 (渲染视图/源代码)
- 📋 源代码一键复制功能
- 💾 支持下载结果
- 🔌 本地演示模式（当无法连接API时）

### Python 脚本
- 🚀 命令行快速测试
- 📊 彩色动态进度条
- 🎨 丰富的颜色文本输出
- 💾 自动保存结果到本地
- 🔗 提供结果访问链接

## 进度显示

### 网页界面
- 动态进度条，实时更新处理状态
- 百分比完成度显示
- 优雅的流光动画效果
- 处理完成后的成功提示

### 命令行工具
- 高级彩色进度条
- 不同阶段使用不同颜色区分
- 动画旋转指示器
- 适配不同终端窗口大小

## 集成的第三方库

### Markdown 渲染
- **markdown-it** - 高性能的 Markdown 解析器
  - 支持 GFM（GitHub Flavored Markdown）
  - 自动链接识别
  - 排版增强
  - 表格支持
  - 列表支持
  - 引用块支持

### 代码高亮
- **highlight.js** - 代码语法高亮库
  - 支持超过190种编程语言
  - 自动语言检测
  - 多种主题样式
  - 适配暗色/亮色模式

## 查看模式

OCR识别结果提供两种查看模式：

### 渲染视图 (默认)
- 使用markdown-it渲染为格式化HTML
- 代码块自动高亮
- 表格、列表等结构化展示
- 支持图片、链接等多媒体元素

### 源代码视图
- 显示原始Markdown文本
- 便于复制或编辑
- 提供一键复制功能
- 使用等宽字体，保持代码格式

## 注意事项

1. 确保网络可以访问 API 服务器（209.20.156.150:8000）
2. 文件大小建议不要超过 10MB
3. 处理时间取决于文件大小和内容复杂度
4. 如果处理时间过长，可能需要稍后重试
5. 需要互联网连接加载第三方库
6. **跨域问题**：直接打开HTML文件会受到浏览器同源策略限制，建议通过本地服务器打开或使用Python脚本 